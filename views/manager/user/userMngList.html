
{%- include("../../include/header.html") %}
<style>
	/* #opa { width: 100%; height: 100%; background: gray; opacity: 0.2; } */
	table .table table-bordered th,td,th{
       text-align: center;
    }
    .userList:hover {
    	background-color : lightgrey;
    }
</style>
<!-- <div id="opa">dummy</div> -->


<div class="content">
	<div class="row">
		<div class="col-sm-12">
			<div class="box box-primary">
				<div class="box-header">
					<h2 class="box-title">고객 관리</h2>
				</div>
				<div class="box-body">
					<!-- 검색 작업에서 유지될 데이터
                        1. 현재 페이지의 번호
                        2. 페이지당 보여지는 데이터의 수
                        3. 검색의 종류
                        4. 검색의 키워드
                     -->
					<input type="checkbox" class="form-check-input" id="alllist"/> 전체회원
					<select name="searchType" id="searchType" style="width:200px; height: 25px;">
						{% if cri.searchType === null %}
						{% set selectednull="selected" %}
						{% else %}
						{% set selectednull = '' %}
						{% endif %}

						<option value="n" {{selectednull}}>======</option>
						{% if cri.searchType === 'userId' %}
						{% set selecteduserid='selected' %}
						{% else %}
						{% set selecteduserid = '' %}
						{% endif %}

						<option value="userId" {{selecteduserid}}>유저아이디</option>

						{% if cri.searchType === 'userName' %}
						{% set selectedusername='selected' %}
						{% else %}
						{% set selectedusername = '' %}
						{% endif %}
						<option value="userName" {{selectedusername}}>유저명</option>

					</select>
					<input type="text" name="keyword" id="keywordInput" value="{{cri.keyword}}">
					<button id="btnSearch">Search</button>
					<button id="btnReset">리셋</button>
				</div>
				<div class="box-body">
					<table class="table table-bordered">
						<colgroup>
							<col style="width: 10%">
							<col style="width: 0%">
							<col style="width: 20%">
							<col style="width: 15%">
							<col style="width: 15%">
							<col style="width: 10%">
						</colgroup>
					  	<thead>
						<tr  scope="col">
							<th style="width:80px;">유저번호</th>
							<th>유저명</th>
							<th>유저아이디</th>
							<th>생년월일</th>
							<th>여권등록여부</th>
							<th>탈퇴</th>
						</tr>
						</thead>
						<!-- 반복 돌면서 list가져오기 -->
						{% for userList in lists %}
						<tr data-click="{{userList.id}}" class="userList">
							<!-- 전체 줄 클릭했을 때 디테일로 넘어가도록 처리할 data-click 속성 선언 -->
							<td  scope="row">{{userList.id}}</td>
							<td>{{userList.username}}</td>
							<td>{{userList.userid}}</td>
							<td>{{userList.userbirth}}</td>

							{% if userList.userpassport === null %}
							{% set color = "pink" %}
							{% else %}
							{% set color = "yellow" %}
							{% endif %}
							<td style="background-color: {{color}};width= ">

								{% if userList.userpassport === null %}
								등록필요
								{% else %}
								등록완료
								{% endif %}
							</td>
							{% if userList.usersecess === true %} 
							<td style="color:blue">회원 </td> 
							{%else%} 
							<td type="color:red"> 탈퇴</td>
							{%endif%}
						</tr>
						{% endfor %}
					</table>

					<center>
						<ul class="pagination" id="pagination"></ul>
					</center>
				</div>


			</div>
		</div>
	</div>
</div>

<script>
	// 조건에 따라 체크박스의 상태를 변경합니다.
	if ({{alllist}} === true) {
		$('#alllist').prop('checked', true)
	} else {
		$('#alllist').prop('checked', false)
	}

	$("#btnSearch").click(function(){
		let searchType = $("#searchType").val();
		let keyword = $("#keywordInput").val();
		let alllist = $("#alllist").prop('checked')

		location.href = "{{basedir | safe}}/userMngList?alllist="+alllist+"&searchType="+searchType+"&keyword="+keyword;
	})


	//각 리스트를 클릭했을 때 디테일로 넘어가는 부분
	$(".userList").click(function(){
		let id = $(this).attr("data-click");
		let searchType = "{{cri.searchType}}";
		let keyword = "{{cri.keyword}}";
		let alllist = $("#alllist").prop('checked')
		location.href = "{{basedir | safe}}/userDetailForm/"+id+"?alllist="+alllist+"&page={{pagingData.currentPage }}&searchType="+searchType+"&keyword="+keyword;
	})

	$("#btnReset").click(function(){
		location.href = "{{basedir | safe}}/userMngList/{{ lists.usersecess}}";
	})
	//추가 버튼 누르면
	$("#btnRegister").click(function(){
		location.href = "{{basedir | safe}}/userRegister";
	})
</script>

	{% block Pagination %}
	{%- include("../../include/pagination.html") %}
	{% endblock %}



	{%- include('../../include/footer.html')%}
