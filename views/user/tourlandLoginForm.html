<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Insert title here</title>
</head>
<link rel="stylesheet" type="text/css" href="/stylesheets/tourlandLoginForm.css"/>

<body>
{% include "../include/userHeader.html" %}
<script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
<script  type="text/javascript">

    $(document).ready(function(){

            $("#btnLogin").click(function () {

                const id = $("#id").val();
                const pass = $("#pass").val();
                axios({
                    url: '/customer/loginForm', // 통신할 웹문서
                    method: 'post', // 통신할 방식
                    data: { // 인자로 보낼 데이터
                      id: id,
                      pass: pass
                    },
                    responseType:'json',
                    responseEncoding:'utf-8'
                  }).then((res)=>{
                    console.log("axios1->", res);
                    console.log("axios2->", res.data.responseText);
                    console.log("axios3->", res.status);

                    if(res.data.responseText === "loginsuccess"){
                        confirm("로그이 완료되었습니다.첫 페이지로 이동합니다.");
                        location.href = "/customer";
                    }
                  }) .catch((error)=> {
                    console.log("555555->", error.response.status);
                    $("#errormsg").text(`아이디와 비밀번호 확인 하세요.${error.response.statusText}`);
                })
                  .finally(function () {
                    // always executed
                  });  
                  

            })

        }
    );


</script>
<section>
    <div id="loginHead">
        <h1>로그인</h1>
        <p>새로운 세상, 투어랜드</p>
    </div>
    <div id="loginBox">
        <form>
            {% if registerSuccess != null %}
                <h3>아이디 또는 비밀번호가 틀렸습니다.<br> 다시 로그인 수행하여 주십시오.</h3>
            {% endif %}
            {% if registerSuccess == null  %}
                <h2>투어랜드</h2>
            {% endif %}
            <div id="loginInnerBox">
                <div id="inputBox">
                    {% if UserStay != null %}
                    <input type="text" name="id" id="id" placeholder="아이디" value="{{UserStay.userid}}">
                    <input type="password" name="pass" id="pass" placeholder="비밀번호"
                           value="{{UserStay.userpass}}">
                    {% else %}
                        <input type="text" name="id" id="id" placeholder="아이디">
                        <input type="password" name="pass" id="pass" placeholder="비밀번호">
                    {% endif %}
                </div>
                <div id="submitBox">
                    <input type="button" id="btnLogin" value="입력">
                </div>
                {% if error != null %}
                    <p class="error">{{error }}</p>
                {% endif %}
            </div>
            <div class='errormsg' id="errormsg"></div>
        </form>
        <div id="loginBtns">
            <button id="join" style="cursor: pointer">회원가입</button>
            <button id="findIDPW" style="cursor: pointer">아이디/비밀번호 찾기</button>
        </div>
        <div id="loginAPI">
            <button id="naver" class="api" style="cursor: pointer">
                <span>NAVER</span> 로그인
            </button>
            <button id="kakao" class="api" style="cursor: pointer">
                <span>kakao</span> 로그인
            </button>
        </div>

    </div>

</section>
<script>
    $("#join").click(function () {
        location.href = "/customer/tourlandRegister";
    })
    $("#findIDPW").click(function () {
        location.href = "/customer/tourlandFindIdPw";
    })
</script>
{%- include "../include/userFooter.html" %}
</body>
</html>
